<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="RptSiguienteEjecucionProcesoCalidad" language="groovy" pageWidth="595" pageHeight="842" columnWidth="535" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20">
	<property name="ireport.zoom" value="1.5"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="70"/>
	<style name="Title" fontName="Arial" fontSize="26" isBold="true" pdfFontName="Helvetica-Bold"/>
	<style name="SubTitle" forecolor="#666666" fontName="Arial" fontSize="18"/>
	<style name="Column header" forecolor="#666666" fontName="Arial" fontSize="12" isBold="true"/>
	<style name="Detail" fontName="Arial" fontSize="12"/>
	<parameter name="ID_EJECUCION_PROCESO" class="java.lang.Long">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[select ('PEDI-'||p.nropedido) as nropedido, c.razonsocial, ('PROD-'||pro.nroproducto) as nroproducto,
pro.nombre AS nombre_producto,
('PIEZ-' || pir.nropieza) as nropieza, pi.nombre AS nombre_pieza,
(e.nombre || ' ' || e.apellido) AS nombre_apellido,
eep.idejecucion as idejecucionetapa,
(SELECT m.nombre
FROM maquina m
WHERE eep.maquina = m.idmaquina
) as maquina,
ep.nombre as proceso_calidad,
ep.herramienta as herramientas,
dpp.fechainicio,
dpp.horainicio,
dpp.fechafin,
dpp.horafin

from ejecucionprocesocalidad eep,
detalleejecucionplanificacioncalidad dep,
detalleplanificacioncalidad dpp,
ejecucionplanificacioncalidad epp,
planificacioncalidad pp,
pedido p,
cliente c,
empleado e,
procesocalidad ep,
pieza pi,
producto pro,
piezareal pir

WHERE
eep.empleado = e.idempleado and
dep.idprocesocalidad = ep.idprocesocalidad AND
eep.idejecucion = dep.ejecucionprocesocalidad and
dep.iddetalle = dpp.iddetalleejecucionplanificacioncalidad and
dpp.pieza = pi.idpieza AND
dep.piezareal = pir.idpiezareal AND
dpp.producto = pro.idproducto AND
dep.idejecucionplanificacioncalidad = epp.idejecucion and
epp.idplanificacioncalidad = pp.idplanificacion and
pp.pedido = p.idpedido AND
p.cliente = c.idcliente AND eep.idejecucion = $P{ID_EJECUCION_PROCESO}]]>
	</queryString>
	<field name="nropedido" class="java.lang.String"/>
	<field name="razonsocial" class="java.lang.String"/>
	<field name="nroproducto" class="java.lang.String"/>
	<field name="nombre_producto" class="java.lang.String"/>
	<field name="nropieza" class="java.lang.String"/>
	<field name="nombre_pieza" class="java.lang.String"/>
	<field name="nombre_apellido" class="java.lang.String"/>
	<field name="idejecucionetapa" class="java.lang.Long"/>
	<field name="maquina" class="java.lang.String"/>
	<field name="proceso_calidad" class="java.lang.String"/>
	<field name="herramientas" class="java.lang.String"/>
	<field name="fechainicio" class="java.util.Date"/>
	<field name="horainicio" class="java.lang.String"/>
	<field name="fechafin" class="java.util.Date"/>
	<field name="horafin" class="java.lang.String"/>
	<variable name="CODIGO_BARRA" class="java.lang.String">
		<variableExpression><![CDATA["mscb-4-"+$F{idejecucionetapa}]]></variableExpression>
		<initialValueExpression><![CDATA[]]></initialValueExpression>
	</variable>
	<variable name="varMaquina" class="java.lang.String">
		<variableExpression><![CDATA[$F{maquina}.equals( null ) ? "" : $F{maquina}]]></variableExpression>
	</variable>
	<variable name="varHerramientas" class="java.lang.String">
		<variableExpression><![CDATA[$F{herramientas}.equals( null ) ? "" : $F{herramientas}]]></variableExpression>
	</variable>
	<detail>
		<band height="258">
			<line>
				<reportElement positionType="FixRelativeToBottom" x="0" y="255" width="555" height="1"/>
				<graphicElement>
					<pen lineWidth="0.5" lineColor="#999999"/>
				</graphicElement>
			</line>
			<staticText>
				<reportElement style="Column header" x="2" y="46" width="82" height="20"/>
				<textElement/>
				<text><![CDATA[Nro Pedido:]]></text>
			</staticText>
			<staticText>
				<reportElement style="Column header" x="2" y="66" width="82" height="20"/>
				<textElement/>
				<text><![CDATA[Nro Producto:]]></text>
			</staticText>
			<staticText>
				<reportElement style="Column header" x="2" y="86" width="68" height="20"/>
				<textElement/>
				<text><![CDATA[Nro Pieza:]]></text>
			</staticText>
			<staticText>
				<reportElement style="Column header" x="2" y="106" width="66" height="20"/>
				<textElement/>
				<text><![CDATA[Empleado:]]></text>
			</staticText>
			<staticText>
				<reportElement style="Column header" x="215" y="46" width="66" height="20"/>
				<textElement/>
				<text><![CDATA[Cliente:]]></text>
			</staticText>
			<staticText>
				<reportElement style="Column header" x="215" y="66" width="66" height="20"/>
				<textElement/>
				<text><![CDATA[Producto:]]></text>
			</staticText>
			<staticText>
				<reportElement style="Column header" x="215" y="86" width="66" height="20"/>
				<textElement/>
				<text><![CDATA[Pieza:]]></text>
			</staticText>
			<textField>
				<reportElement x="84" y="46" width="131" height="20"/>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{nropedido}.toUpperCase()]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="281" y="46" width="274" height="20"/>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{razonsocial}.toUpperCase()]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="84" y="66" width="131" height="20"/>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{nroproducto}.toUpperCase()]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="281" y="66" width="274" height="20"/>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{nombre_producto}.toUpperCase()]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="84" y="86" width="131" height="20"/>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{nropieza}.toUpperCase()]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="281" y="86" width="274" height="20"/>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{nombre_pieza}.toUpperCase()]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="84" y="106" width="131" height="20"/>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{nombre_apellido}.toUpperCase()]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement style="Title" x="2" y="1" width="553" height="33"/>
				<textElement verticalAlignment="Middle"/>
				<text><![CDATA[Orden de Trabajo: Calidad]]></text>
			</staticText>
			<componentElement>
				<reportElement x="2" y="188" width="553" height="46"/>
				<jr:barbecue xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd" type="Code39 (Extended)" drawText="false" checksumRequired="false">
					<jr:codeExpression><![CDATA[$V{CODIGO_BARRA}.toString()]]></jr:codeExpression>
				</jr:barbecue>
			</componentElement>
			<textField>
				<reportElement x="2" y="234" width="553" height="20"/>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[$V{CODIGO_BARRA}]]></textFieldExpression>
			</textField>
			<line>
				<reportElement positionType="FixRelativeToBottom" x="0" y="0" width="555" height="1"/>
				<graphicElement>
					<pen lineWidth="0.5" lineColor="#999999"/>
				</graphicElement>
			</line>
			<staticText>
				<reportElement style="Column header" x="215" y="106" width="66" height="20"/>
				<textElement/>
				<text><![CDATA[MÃ¡quina:]]></text>
			</staticText>
			<textField>
				<reportElement x="281" y="106" width="274" height="20"/>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[$V{varMaquina}.toUpperCase()]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement style="Column header" x="2" y="126" width="124" height="20"/>
				<textElement/>
				<text><![CDATA[Proceso de Calidad:]]></text>
			</staticText>
			<textField>
				<reportElement x="126" y="126" width="429" height="20"/>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{proceso_calidad}.toUpperCase()]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement style="Column header" x="2" y="146" width="92" height="20"/>
				<textElement/>
				<text><![CDATA[Herramientas:]]></text>
			</staticText>
			<textField>
				<reportElement x="94" y="146" width="461" height="20"/>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[$V{varHerramientas}.toUpperCase()]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement style="Column header" x="2" y="166" width="92" height="20"/>
				<textElement/>
				<text><![CDATA[Inicio Previsto:]]></text>
			</staticText>
			<textField pattern="dd/MM/yyyy">
				<reportElement x="94" y="166" width="59" height="20"/>
				<textElement/>
				<textFieldExpression class="java.util.Date"><![CDATA[$F{fechainicio}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="153" y="166" width="62" height="20"/>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{horainicio}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement style="Column header" x="215" y="166" width="76" height="20"/>
				<textElement/>
				<text><![CDATA[Fin Previsto:]]></text>
			</staticText>
			<textField pattern="dd/MM/yyyy">
				<reportElement x="291" y="166" width="55" height="20"/>
				<textElement/>
				<textFieldExpression class="java.util.Date"><![CDATA[$F{fechafin}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="346" y="166" width="81" height="20"/>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{horafin}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
</jasperReport>
